# Example baseline nftables configuration for the protected server.
#
# The sync client automatically creates and manages:
#   set  the_tyler_allowed_ips  (IPv4 addresses from the web app)
#   set  the_tyler_ports        (TCP ports from NFT_PORTS config)
#   chain the_tyler_allowlist   (accept @the_tyler_allowed_ips; drop)
#   rule  in the input chain    (tcp dport @the_tyler_ports jump the_tyler_allowlist)
#
# This file only needs to define the base table skeleton.
# The sync client will create its objects the first time it runs.
#
# Load with: nft -f /etc/nftables.conf

table inet filter {
  chain input {
    type filter hook input priority 0; policy drop;

    # Allow established/related connections
    ct state established,related accept

    # Allow loopback
    iif lo accept

    # Allow SSH (adjust port as needed)
    tcp dport 22 accept

    # The sync client inserts its jump rule here automatically.
    # You do not need to add it manually.
  }

  chain forward {
    type filter hook forward priority 0; policy drop;
  }

  chain output {
    type filter hook output priority 0; policy accept;
  }
}
